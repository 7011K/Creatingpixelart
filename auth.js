const GOOGLE_CLIENT_ID="341073342979-gfrpfpg3ag766tadn9rjnckrn7gd28sp.apps.googleusercontent.com";export let userEmail="";export function setupGoogleLogin(onLoginOK){if(!window.google||!window.google.accounts){const script=document.createElement('script');script.src="https://accounts.google.com/gsi/client";script.async=!0;script.defer=!0;document.head.appendChild(script);script.onload=()=>{initLogin(onLoginOK)}}else{initLogin(onLoginOK)}} async function checkBanStatus(email){try{const response=await fetch("https://bancheckapicreatingpixelart.vercel.app/api/Creatingpixelartbancheckapi",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email})});const result=await response.json();console.log("BANチェック結果:",result);userEmail=result.email||""}catch(error){console.error("BANチェック失敗:",error);userEmail=""}} function initLogin(onLoginOK){google.accounts.id.initialize({client_id:GOOGLE_CLIENT_ID,callback:async(response)=>{try{const token=response.credential;const payload=JSON.parse(atob(token.split('.')[1]));const rawEmail=payload.email?payload.email.toLowerCase():'';await checkBanStatus(rawEmail);if(typeof onLoginOK==="function")onLoginOK(userEmail)}catch(err){console.error("ログイン処理失敗:",err);userEmail="";if(typeof onLoginOK==="function")onLoginOK("")}},auto_select:!1});google.accounts.id.renderButton(document.getElementById("googleSignInBtn"),{theme:"outline",size:"large"})}
